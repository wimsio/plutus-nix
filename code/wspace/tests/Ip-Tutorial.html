<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>IP Management Smart Contract Tutorial</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #fdfdfd;
      padding: 20px;
      line-height: 1.7;
      color: #222;
      max-width: 1200px;
      margin: auto;
    }
    h1, h2, h3 {
      color: #002b45;
    }
    pre {
      background: #f4f4f4;
      padding: 15px;
      border-radius: 6px;
      overflow-x: auto;
      border-left: 4px solid #0077cc;
    }
    code {
      background: #eee;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: "Consolas", monospace;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th {
      background: #002b45;
      color: white;
      padding: 12px;
    }
    td {
      padding: 10px;
      vertical-align: top;
    }
    a {
      color: #0077cc;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    ul, ol {
      padding-left: 1.5em;
    }
    .note {
      background: #e7f3ff;
      padding: 15px;
      border-radius: 6px;
      border-left: 4px solid #0077cc;
      margin: 15px 0;
    }
    .warning {
      background: #fff3e0;
      padding: 15px;
      border-radius: 6px;
      border-left: 4px solid #ff9800;
      margin: 15px 0;
    }
    .function {
      background: #f0f7ff;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
    }
    .action {
      background: #f0fff0;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
      border-left: 4px solid #4caf50;
    }
    .transfer {
      background: #fff3e0;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
      border-left: 4px solid #ff9800;
    }
    .workflow {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
    }
    .diagram {
      background: #f8f8f8;
      padding: 20px;
      border-radius: 6px;
      margin: 20px 0;
      text-align: center;
    }
    .state-machine {
      background: #fff;
      border: 2px solid #002b45;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    .state {
      background: #002b45;
      color: white;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
      text-align: center;
    }
    .ip-example {
      background: #f0f7ff;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #2196f3;
    }
  </style>
</head>
<body>

  <h1>ğŸ“š Intellectual Property Management Smart Contract Tutorial</h1>

  <p>This tutorial covers the Intellectual Property (IP) Management smart contract, which implements a decentralized system for registering, tracking, and transferring intellectual property rights on the blockchain. The contract uses NFTs to represent unique IP assets and provides secure mechanisms for ownership management.</p>

  <hr>

  <h2>ğŸ“š Table of Contents</h2>
  <ol>
    <li><a href="#1-overview">ğŸ¢ Overview</a></li>
    <li><a href="#2-imports-overview">ğŸ“¦ Imports Overview</a></li>
    <li><a href="#3-data-structures">ğŸ—ƒï¸ Data Structures</a></li>
    <li><a href="#4-redeemer-actions">ğŸ¯ Redeemer Actions</a></li>
    <li><a href="#5-helper-functions">ğŸ”§ Helper Functions</a></li>
    <li><a href="#6-core-validator-logic">ğŸ§  Core Validator Logic</a></li>
    <li><a href="#7-ip-management-workflow">ğŸ”„ IP Management Workflow</a></li>
    <li><a href="#8-state-transitions">ğŸ“Š State Transitions</a></li>
    <li><a href="#9-script-compilation">âš™ï¸ Script Compilation</a></li>
    <li><a href="#10-practical-usage">ğŸ§ª Practical Usage</a></li>
    <li><a href="#11-legal-considerations">âš–ï¸ Legal Considerations</a></li>
    <li><a href="#12-glossary">ğŸ“˜ Glossary</a></li>
  </ol>

  <hr>

  <h2 id="1-overview">1. ğŸ¢ Overview</h2>

  <p>The Intellectual Property Management smart contract implements a comprehensive system for:</p>

  <ul>
    <li><strong>IP Registration</strong>: Creating immutable records of intellectual property</li>
    <li><strong>Ownership Tracking</strong>: Maintaining verifiable ownership history</li>
    <li><strong>Secure Transfers</strong>: Facilitating authorized ownership transfers</li>
    <li><strong>NFT Representation</strong>: Using unique tokens to represent IP assets</li>
    <li><strong>Content Integrity</strong>: Ensuring IP content remains tamper-proof</li>
  </ul>

  <div class="note">
    <strong>Digital Rights Management:</strong> This contract provides a foundation for decentralized IP management, enabling creators to establish provable ownership and transfer rights without intermediaries.
  </div>

  <h2 id="2-imports-overview">2. ğŸ“¦ Imports Overview</h2>

  <h3>Core Plutus Modules</h3>
  <ul>
    <li><strong>Plutus.V2.Ledger.Api</strong>: Core types (<code>PubKeyHash</code>, <code>CurrencySymbol</code>, <code>TokenName</code>, <code>ScriptContext</code>)</li>
    <li><strong>Plutus.V2.Ledger.Contexts</strong>: Transaction context utilities (<code>txSignedBy</code>, <code>getContinuingOutputs</code>)</li>
    <li><strong>Plutus.V1.Ledger.Value</strong>: Token value operations (<code>valueOf</code>)</li>
  </ul>

  <h3>Serialization & Haskell Extensions</h3>
  <ul>
    <li><strong>PlutusTx</strong>: Script compilation and template haskell</li>
    <li><strong>Codec.Serialise</strong>: Binary serialization for on-chain scripts</li>
    <li><strong>DeriveGeneric/AnyClass</strong>: Automatic instance derivation</li>
  </ul>

  <h2 id="3-data-structures">3. ğŸ—ƒï¸ Data Structures</h2>

  <h3><code>IPDatum</code></h3>
  <p>Stores comprehensive intellectual property information:</p>
  <ul>
    <li><strong>ipOwner</strong>: Current owner's public key hash</li>
    <li><strong>ipTitle</strong>: Title or name of the intellectual property</li>
    <li><strong>ipContentId</strong>: Cryptographic hash of the IP content</li>
    <li><strong>ipLicensed</strong>: Boolean indicating licensing status</li>
    <li><strong>ipCurrency</strong>: Currency symbol of the associated NFT</li>
    <li><strong>ipToken</strong>: Token name of the specific IP NFT</li>
  </ul>

  <pre><code>data IPDatum = IPDatum
    { ipOwner     :: PubKeyHash
    , ipTitle     :: BuiltinByteString
    , ipContentId :: BuiltinByteString
    , ipLicensed  :: Bool
    , ipCurrency  :: CurrencySymbol
    , ipToken     :: TokenName
    }</code></pre>

  <h3>IP Content Identification</h3>
  <p>The contract uses multiple identifiers for comprehensive IP tracking:</p>
  <table>
    <tr><th>Field</th><th>Purpose</th><th>Example</th></tr>
    <tr><td>ipTitle</td><td>Human-readable IP title</td><td>"Digital Art Collection #1"</td></tr>
    <tr><td>ipContentId</td><td>Hash of actual IP content</td><td>SHA-256 of artwork file</td></tr>
    <tr><td>ipCurrency/Token</td><td>NFT identification</td><td>PolicyID + "IP#001"</td></tr>
  </table>

  <h2 id="4-redeemer-actions">4. ğŸ¯ Redeemer Actions</h2>

  <h3><code>IPRedeemer</code></h3>
  <p>Defines the two core operations for IP management:</p>

  <div class="action">
    <strong>Register</strong><br>
    Initial registration of intellectual property. Creates the first on-chain record and associates it with an NFT.
  </div>

  <div class="transfer">
    <strong>Transfer PubKeyHash</strong><br>
    Ownership transfer to a new owner. Validates current owner authorization and ensures proper state continuation.
  </div>

  <h2 id="5-helper-functions">5. ğŸ”§ Helper Functions</h2>

  <h3><code>validateRegister</code></h3>
  <pre><code>{-# INLINABLE validateRegister #-}
validateRegister :: IPDatum -> ScriptContext -> Bool
validateRegister dat ctx =
    traceIfFalse "registration not signed by owner" signedByOwner &&
    traceIfFalse "NFT not present" nftPresent</code></pre>
  <p>Validates initial IP registration by ensuring owner authorization and NFT association.</p>

  <h3><code>validateTransfer</code></h3>
  <pre><code>{-# INLINABLE validateTransfer #-}
validateTransfer :: IPDatum -> PubKeyHash -> ScriptContext -> Bool
validateTransfer dat newOwner ctx =
    traceIfFalse "transfer not signed by current owner" signedByOldOwner &&
    traceIfFalse "no continuing output with new owner" hasValidContinuing &&
    traceIfFalse "NFT missing in continuing output" nftPresent</code></pre>
  <p>Validates ownership transfers with comprehensive state continuity checks.</p>

  <h2 id="6-core-validator-logic">6. ğŸ§  Core Validator Logic</h2>

  <h3><code>mkIPValidator</code></h3>
  <p>The main validation function that routes to specific validation logic:</p>

  <h4>Register Validation (Initial Creation)</h4>
  <ul>
    <li>âœ… Must be signed by the declared owner</li>
    <li>âœ… Associated NFT must be present in outputs</li>
    <li>âŒ Fails if owner signature missing</li>
    <li>âŒ Fails if NFT not properly associated</li>
  </ul>

  <h4>Transfer Validation (Ownership Change)</h4>
  <ul>
    <li>âœ… Must be signed by current owner</li>
    <li>âœ… Must have exactly one continuing output</li>
    <li>âœ… Continuing output must have new owner</li>
    <li>âœ… IP metadata must remain unchanged</li>
    <li>âœ… NFT must transfer to new output</li>
    <li>âŒ Fails if current owner signature missing</li>
    <li>âŒ Fails if IP metadata altered during transfer</li>
    <li>âŒ Fails if NFT missing from continuing output</li>
  </ul>

  <div class="warning">
    <strong>Data Integrity:</strong> The transfer validation ensures that critical IP metadata (title, content ID, licensing status) cannot be altered during ownership transfers, preserving the integrity of the intellectual property record.
  </div>

  <h3>Continuing Output Validation</h3>
  <p>The transfer logic includes sophisticated continuing output checks:</p>
  <pre><code>hasValidContinuing :: Bool
hasValidContinuing =
    case continuing of
        [o] -> case txOutDatum o of
            OutputDatum (Datum d) ->
                case PlutusTx.fromBuiltinData d of
                    Just (IPDatum newOwner' title' content' licensed' _ _) ->
                        newOwner' == newOwner &&
                        title' == ipTitle dat &&
                        content' == ipContentId dat &&
                        licensed' == ipLicensed dat
                    _ -> False
            _ -> False
        _ -> False</code></pre>

  <h2 id="7-ip-management-workflow">7. ğŸ”„ IP Management Workflow</h2>

  <div class="workflow">
    <h3>Complete IP Lifecycle Management</h3>
    
    <div class="diagram">
      <strong>ğŸ“š Intellectual Property Lifecycle</strong><br>
      Creation â†’ Registration â†’ Ownership â†’ Transfer â†’ New Ownership
    </div>

    <div class="ip-example">
      <h4>Example: Digital Artwork Registration</h4>
      <pre><code>IPDatum {
  ipOwner = "artist_pkh",
  ipTitle = "Digital Sunset #1",
  ipContentId = "a1b2c3...sha256_hash...",  -- Hash of artwork file
  ipLicensed = False,                       -- Not currently licensed
  ipCurrency = "art_policy_123",            -- NFT policy ID
  ipToken = "Sunset#001"                    -- Unique token identifier
}</code></pre>
    </div>

    <h4>1. Initial Registration</h4>
    <pre><code>Action: Register
Validation:
  - Artist signature âœ…
  - NFT present in outputs âœ…
  - IP metadata recorded âœ…
Result: IP successfully registered on-chain</code></pre>

    <h4>2. Ownership Transfer to Collector</h4>
    <pre><code>Action: Transfer "collector_pkh"
Validation:
  - Current owner (artist) signature âœ…
  - Continuing output with new owner âœ…
  - IP metadata unchanged âœ…
  - NFT transferred to new output âœ…
Result: Ownership transferred to collector</code></pre>

    <h4>3. Invalid Transfer Attempt</h4>
    <pre><code>Action: Transfer "unauthorized_pkh"
Validation:
  - Unauthorized signature âŒ
  - Fails: "transfer not signed by current owner"
Result: Transfer rejected</code></pre>

    <h4>4. Metadata Alteration Attempt</h4>
    <pre><code>Action: Transfer (with modified title)
Validation:
  - Owner signature âœ…
  - Title changed in continuing output âŒ
  - Fails: metadata integrity check
Result: Transfer rejected</code></pre>
  </div>

  <h2 id="8-state-transitions">8. ğŸ“Š State Transitions</h2>

  <div class="state-machine">
    <h3>IP Management State Machine</h3>
    
    <div class="state">ğŸš« INITIAL STATE: No IP Record</div>
    
    <p><strong>Transition 1: IP Registration</strong></p>
    <ul>
      <li>Trigger: Owner executes Register</li>
      <li>Conditions: Owner signature + NFT present</li>
      <li>State Change: IP record created with owner</li>
      <li>New State: âœ… IP Registered & Owned</li>
    </ul>
    
    <div class="state">âœ… STATE: IP Registered & Owned</div>
    
    <p><strong>Transition 2: Ownership Transfer</strong></p>
    <ul>
      <li>Trigger: Current owner executes Transfer</li>
      <li>Conditions: Owner signature + valid continuing output</li>
      <li>State Change: Ownership transferred, metadata preserved</li>
      <li>New State: âœ… IP Registered with New Owner</li>
    </ul>
    
    <p><strong>Invariant Protection:</strong></p>
    <ul>
      <li>ğŸ”’ IP metadata cannot be altered during transfers</li>
      <li>ğŸ”’ Only current owner can authorize transfers</li>
      <li>ğŸ”’ NFT must always be associated with IP record</li>
      <li>ğŸ”’ Content hash provides tamper-proof integrity</li>
    </ul>
  </div>

  <h2 id="9-script-compilation">9. âš™ï¸ Script Compilation</h2>

  <h3><code>mkUntypedValidator</code></h3>
  <p>Wraps the typed validator for Plutus compatibility:</p>
  <pre><code>{-# INLINABLE mkUntypedValidator #-}
mkUntypedValidator ::
    (IPDatum -> IPRedeemer -> ScriptContext -> Bool)
    -> BuiltinData -> BuiltinData -> BuiltinData -> ()
mkUntypedValidator f d r c =
    check $ f (unsafeFromBuiltinData d) (unsafeFromBuiltinData r) (unsafeFromBuiltinData c)</code></pre>

  <h3><code>validator</code></h3>
  <p>Compiles the validator into executable Plutus Core script:</p>
  <pre><code>validator :: Validator
validator = mkValidatorScript
    $$(PlutusTx.compile [|| mkUntypedValidator mkIPValidator ||])</code></pre>

  <h2 id="10-practical-usage">10. ğŸ§ª Practical Usage</h2>

  <h3>Deployment Steps</h3>
  <pre><code>-- Compile and deploy the IP validator
main :: IO ()
main = do
    let file = "ip-smartcontract-nft.plutus"
    writeValidator file validator
    H.putStrLn "IP Smart Contract with NFT support built successfully!"</code></pre>

  <h3>Integration with IP Management Systems</h3>
  <pre><code>-- Example: Register New IP
registerIP :: PubKeyHash -> String -> String -> CurrencySymbol -> TokenName -> Tx
registerIP owner title contentHash currency token = ...

-- Example: Transfer IP Ownership
transferIP :: ValidatorHash -> PubKeyHash -> PubKeyHash -> Tx
transferIP valHash currentOwner newOwner = ...

-- Example: Verify IP Ownership
verifyOwnership :: ValidatorHash -> PubKeyHash -> Bool
verifyOwnership valHash owner = ...</code></pre>

  <h3>Supported IP Types</h3>
  <table>
    <tr><th>IP Type</th><th>Content Examples</th><th>Hash Method</th></tr>
    <tr><td>Digital Art</td><td>Images, 3D models, animations</td><td>SHA-256 of image file</td></tr>
    <tr><td>Written Content</td><td>Articles, books, poetry</td><td>SHA-256 of text file</td></tr>
    <tr><td>Music & Audio</td><td>Songs, podcasts, sound effects</td><td>SHA-256 of audio file</td></tr>
    <tr><td>Software Code</td><td>Source code, algorithms</td><td>SHA-256 of code repository</td></tr>
    <tr><td>Design Files</td><td>CAD files, blueprints</td><td>SHA-256 of design file</td></tr>
  </table>

  <h2 id="11-legal-considerations">11. âš–ï¸ Legal Considerations</h2>

  <h3>Jurisdictional Compliance</h3>
  <ul>
    <li><strong>Copyright Laws</strong>: Vary by country - consult local regulations</li>
    <li><strong>Digital Signatures</strong>: Ensure legal recognition in relevant jurisdictions</li>
    <li><strong>Data Privacy</strong>: Consider GDPR and similar regulations</li>
    <li><strong>International Transfers</strong>: Address cross-border legal frameworks</li>
  </ul>

  <h3>Legal Limitations</h3>
  <ul>
    <li><strong>Not Legal Proof</strong>: Blockchain registration â‰  legal copyright</li>
    <li><strong>Enforcement Challenges</strong>: On-chain records support but don't replace legal action</li>
    <li><strong>Dispute Resolution</strong>: Need off-chain mechanisms for conflicts</li>
    <li><strong>Content Verification</strong>: Hash proves existence, not creation date</li>
  </ul>

  <h3>Best Practices</h3>
  <ul>
    <li>Maintain off-chain backups of original content</li>
    <li>Use timestamping services for creation date proof</li>
    <li>Implement multi-signature for valuable IP</li>
    <li>Include metadata standards (IPTC, EXIF, etc.)</li>
    <li>Consider legal wrapper contracts for important IP</li>
  </ul>

  <div class="warning">
    <strong>Legal Disclaimer:</strong> This smart contract provides technical means for IP tracking but does not constitute legal advice. Consult with intellectual property attorneys for legal protection strategies in your jurisdiction.
  </div>

  <h2 id="12-glossary">12. ğŸ“˜ Glossary</h2>

  <table>
    <tr><th>Term</th><th>Definition</th></tr>
    <tr><td><strong>Intellectual Property (IP)</strong></td><td>Creations of the mind protected by law (copyrights, patents, trademarks)</td></tr>
    <tr><td><strong>Content Hash</strong></td><td>Cryptographic fingerprint of digital content used for integrity verification</td></tr>
    <tr><td><strong>NFT (Non-Fungible Token)</strong></td><td>Unique cryptographic token representing ownership of specific asset</td></tr>
    <tr><td><strong>Continuing Output</strong></td><td>UTxO that continues the state machine in a new transaction</td></tr>
    <tr><td><strong>Datum</strong></td><td>On-chain data stored with UTxO that parameterizes script behavior</td></tr>
    <tr><td><strong>Redeemer</strong></td><td>Script input that determines which validation path to execute</td></tr>
    <tr><td><strong>Public Key Hash (PKH)</strong></td><td>Cryptographic hash of public key used to identify wallet addresses</td></tr>
    <tr><td><strong>Currency Symbol</strong></td><td>Unique identifier for token minting policy on Cardano</td></tr>
    <tr><td><strong>Token Name</strong></td><td>Specific identifier within a currency policy for individual tokens</td></tr>
    <tr><td><strong>Metadata Integrity</strong></td><td>Ensuring IP information remains unchanged during state transitions</td></tr>
    <tr><td><strong>Ownership Chain</strong></td><td>Verifiable history of ownership transfers</td></tr>
    <tr><td><strong>Digital Rights Management</strong></td><td>Technological control over use of digital content</td></tr>
  </table>

  <div class="note">
    <strong>Production Enhancements:</strong> For enterprise IP management, consider adding:
    <ul>
      <li>Royalty payment mechanisms for licensed IP</li>
      <li>Time-limited licensing with expiration</li>
      <li>Multi-party ownership with percentage splits</li>
      <li>IP verification and certification services</li>
      <li>Integration with traditional IP registries</li>
      <li>Dispute resolution and arbitration mechanisms</li>
      <li>Advanced metadata standards support</li>
      <li>Cross-chain interoperability for broader adoption</li>
    </ul>
  </div>

</body>
</html>